# Retrospective — Epic 9: Client SDKs

**Date:** 2026-02-21
**Facilitator:** Bob (Scrum Master)
**Project Lead:** Lucas

## Epic Summary

| Metric | Value |
|--------|-------|
| Stories | 5/5 completed (100%) |
| Scope | Go, Python, JavaScript/Node.js, Ruby, Java client SDKs |
| Languages Shipped | 5 (+ Rust SDK from Epic 7 = 6 total) |
| New Repos | 5 (fila-go, fila-python, fila-js, fila-ruby, fila-java) |
| Integration Tests | 15+ new across 5 repos |
| Existing Test Suite | 278 tests (unchanged, zero regressions) |
| Code Review Findings | Silent test timeout (JS), rubocop offenses (Ruby), same-stream nack pattern (JS) |
| Technical Debt Incurred | SDK CI integration tests silently skipped (to be fixed in Epic 10) |

## Team Participants

- Bob (Scrum Master) — Facilitator
- Alice (Product Owner) — Business perspective
- Charlie (Senior Dev) — Technical lead
- Dana (QA Engineer) — Quality perspective
- Elena (Junior Dev) — Fresh perspective
- Lucas (Project Lead) — Decision maker

## Successes

1. **Ninth consecutive epic at 100% completion** — 5/5 stories delivered. Fila went from Rust-only to 6-language SDK coverage (Go, Python, JS, Ruby, Java + Rust from Epic 7).

2. **Pattern replication was remarkably smooth** — The Rust SDK from Epic 7 established the API shape (enqueue, consume, ack, nack with per-operation error types). Each subsequent SDK mirrored it idiomatically. By Ruby and Java, the recipe was fully dialed in.

3. **Epic 8 retro decisions paid off** — Separate repos per SDK, copied protos with committed generated code (no submodules, no Buf), sharpened story ACs. Zero friction from these architectural decisions.

4. **Code review caught real issues across stories** — JS SDK: silent timeout in test helper fixed, nack test corrected to same-stream pattern. Ruby: rubocop auto-corrected 110 offenses. Java: `grpc-netty-shaded` chosen to avoid version conflicts.

5. **Language-specific gotchas handled inline, not as blockers** — Python namespace collision, Ruby needing Homebrew Ruby 4.0, JS choosing `proto-loader-gen-types` over `ts-proto`. Each solved during story execution.

6. **Consistent test coverage** — Every SDK has 3+ integration tests following the same pattern: subprocess server, admin gRPC for setup, SDK client for verification.

7. **Encode-or-drop validated for ninth consecutive epic** — All 4 action items + 2 pre-epic tasks from Epic 8 retro completed (100%).

## Challenges

1. **Integration tests silently skipped in all 5 SDK CIs** — Same gap pattern as Epic 8 Story 8.1. The CLAUDE.md CI requirement ensured CI pipelines were created (the encoding worked), but the agent chose the easy path: `skip-if-not-found` instead of provisioning `fila-server` in CI. Integration tests existed but never ran. As Lucas observed: "the agent did not forget about CI — that proves our update from Epic 8 works. But it decided to skip something in CI instead of doing something harder."

2. **SDK CI builds fila-server from source (~8 min)** — All 5 SDK repos check out fila, install Rust+protoc, and `cargo build --release`. Works but slow and fragile. No pre-built binaries available for download.

3. **Story status tracking drift** — Stories 9.1-9.3 still show "Status: review" in their story files while 9.4-9.5 show "Status: done". Sprint-status.yaml is correct (all done). Cosmetic — dropped as not worth fixing.

## Key Insights

1. **Encoding requirements works; encoding quality requires specificity** — "Include CI" produced CI pipelines. But "include CI" didn't produce CI that _runs integration tests_. The requirement needed teeth: tests must actually execute, not just exist. Now encoded in CLAUDE.md with explicit "Integration Tests Must Actually Run" section.

2. **Release infrastructure is a prerequisite, not an afterthought** — SDK CIs need pre-built server binaries. Documentation needs installable packages. Docker images need release artifacts. The release pipeline must be front-loaded in Epic 10.

3. **Pattern replication scales linearly** — Once the Rust SDK established the API shape in Epic 7, each additional language SDK was straightforward. The investment in getting the first SDK right (including Lucas's per-operation error types review) paid dividends 5x over.

4. **Separate repos per SDK was the right call** — Different release lifecycles, build tools, CI configurations, and package managers. A monorepo would have been impractical.

## Previous Retrospective Follow-Through

### Epic 8 Encoded Action Items

| # | Action Item | Status | Evidence |
|---|-------------|--------|----------|
| 1 | Encode CI requirement for new projects/crates in CLAUDE.md | ✅ Completed | CLAUDE.md CI section exists; all 5 SDK repos have CI |
| 2 | Record Epic 8 results in MEMORY.md | ✅ Completed | "Epic 8 Results" section present |
| 3 | Update encode-or-drop count to 8 epics | ✅ Completed | MEMORY.md updated |
| 4 | Sprint-status: epic-8-retrospective → done | ✅ Completed | sprint-status.yaml confirms |

### Epic 8 Pre-Epic Tasks

| # | Task | Status | Evidence |
|---|------|--------|----------|
| 1 | Rename Lease → Consume on all user-facing surfaces | ✅ Completed | All 5 SDKs use `consume` as API verb |
| 2 | Sharpen Epic 9 story ACs | ✅ Completed | All stories have explicit CI, integration test, proto tasks |

**Encoded items: 4/4 completed (100%). Pre-epic tasks: 2/2 completed (100%).**

### Lessons Applied from Epic 8

- Per-operation error types pattern continued across all 5 SDKs (originated from Lucas's Epic 7 PR #30 review)
- Separate repos per SDK as decided in Epic 8 retro — zero cross-repo friction
- Copied protos + committed generated code — no submodule issues in any SDK

## Design Decisions

- **Epic 10 reshaped from 4 to 5 stories** — Release infrastructure front-loaded:
  - 10.1: Server + CLI release pipeline + Docker image (bleeding-edge from main)
  - 10.2: SDK package publishing (npm, PyPI, crates.io, RubyGems, Maven Central)
  - 10.3: Binary distribution & installation (`cargo install`, `curl | bash`)
  - 10.4: Core documentation & API reference
  - 10.5: Tutorials, examples & Lua patterns
- **Bleeding-edge releases from main** — every push to main produces a GitHub Release tagged by commit hash. Pre-release, not semver. Used by SDK CIs to download pre-built binaries.
- **SDK package publishing** — all 6 SDKs to be published to their respective registries with dev/pre-release versioning.
- **CI gate strengthened** — CLAUDE.md now requires integration tests to actually execute in CI, not silently skip. Tests must provision dependencies or fail explicitly.

## Next Epic Preview — Epic 10: Distribution & Documentation

**5 stories planned (reshaped):**

1. **Story 10.1: Server & CLI Release Pipeline + Docker Image** — Bleeding-edge releases, Docker image
2. **Story 10.2: SDK Package Publishing** — All 6 SDKs to package registries
3. **Story 10.3: Binary Distribution & Installation** — `cargo install`, `curl | bash`
4. **Story 10.4: Core Documentation & API Reference** — README, concepts, API ref, llms.txt
5. **Story 10.5: Tutorials, Examples & Lua Patterns** — Guided tutorials, per-SDK examples

**Dependencies on Epic 9:**
- All 5 SDK repos exist with CI, integration tests, and packaging scaffolding
- SDK patterns inform release strategy and documentation

**Key preparation from this retro:**
- Release pipeline is Story 10.1 (not a pre-epic task)
- SDK CI integration test fix rolls into Story 10.2 (update CIs to download pre-built binary)
- No pre-epic tasks needed — everything is encoded in stories

## Action Items — Encoded Changes

Every action item has been encoded into a file that agents read during execution.

### Changes Made During This Retro

| # | Action | File Changed | Type |
|---|--------|-------------|------|
| 1 | Strengthen CI requirement: integration tests must actually run | `CLAUDE.md` | Project instruction |
| 2 | Reshape Epic 10 from 4 to 5 stories | `epics.md` | Planning artifact |
| 3 | Record Epic 9 results, release decisions, codebase health | `memory/MEMORY.md` | Memory update |
| 4 | Update encode-or-drop count to 9 epics | `memory/MEMORY.md` | Memory update |
| 5 | Sprint-status: epic-9-retrospective → done | `sprint-status.yaml` | Tracking update |

### Explicitly Dropped

| # | Proposed Action | Reason for Drop |
|---|----------------|-----------------|
| 1 | Fix story status drift (9.1-9.3 say "review") | Cosmetic — sprint-status.yaml is the source of truth. Story files are historical records. |

## Readiness Assessment

| Area | Status | Details |
|------|--------|---------|
| Testing & Quality | Ready | 278 tests in fila, 15+ SDK integration tests, all passing locally |
| Deployment | N/A | Pre-release project |
| Stakeholder Acceptance | Accepted | Lucas reviewed and approved |
| Technical Health | Ready | 6 SDK repos with CI, packaging scaffolding, READMEs |
| Unresolved Blockers | None | SDK CI silent skip is known and addressed by Epic 10 Story 10.2 |

## Closure

**Key Takeaways:**

1. Encoding requirements works; encoding _quality_ requires specificity — "include CI" isn't enough, "integration tests must actually run" is
2. Release infrastructure must be front-loaded, not bolted on after features ship
3. Pattern replication scales linearly — invest in getting the first implementation right
4. Ninth consecutive epic at 100% — encode-or-drop validated again

**Changes Executed:**
- CLAUDE.md updated (strengthened CI gate with "Integration Tests Must Actually Run" section)
- MEMORY.md updated (Epic 9 results, encode-or-drop count, codebase health, release strategy)
- epics.md updated (Epic 10 reshaped from 4 to 5 stories)
- Sprint-status updated: epic-9-retrospective → done

**Next Steps:**

1. Begin Epic 10 story creation — Story 10.1 (release pipeline) first
2. Story 10.1 unblocks everything: SDK CIs, Docker image, binary distribution, docs
3. No pre-epic tasks needed — all preparation is encoded in Epic 10 stories
4. Each story's ACs already include CI and integration test requirements

**Epic 9 delivered 5 idiomatic client SDKs across Go, Python, JavaScript, Ruby, and Java.** Fila now has full-stack language coverage for the hot-path API. The release pipeline and documentation in Epic 10 are the final mile to making Fila usable by the world.
